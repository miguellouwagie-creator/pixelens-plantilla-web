---
import { client } from "../lib/sanity";

// Pedimos las 3 reseñas más recientes
const resenas = await client.fetch(`*[_type == "resena"] | order(_createdAt desc)[0..2]`);
---

{resenas && resenas.length > 0 && (
  <section class="bg-white py-20 border-t border-gray-100">
    <div class="container mx-auto px-6">
      
      <div class="text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold text-gray-900 font-serif mb-4">Lo que dicen nuestros clientes</h2>
        <div class="h-1 w-20 bg-orange-700 mx-auto"></div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        {resenas.map((resena: any) => (
          <div class="bg-stone-50 p-8 rounded-xl shadow-sm hover:shadow-md transition duration-300 border border-gray-100 relative">
            <div class="text-6xl text-orange-200 absolute top-4 right-6 font-serif opacity-50">”</div>
            
            <div class="flex mb-4 text-orange-500 text-lg">
              {Array.from({ length: resena.puntuacion }).map(() => (
                <span>★</span>
              ))}
            </div>

            <p class="text-gray-600 italic mb-6 leading-relaxed relative z-10">
              "{resena.texto}"
            </p>

            <div class="flex items-center justify-between border-t border-gray-200 pt-4 mt-auto">
              <span class="font-bold text-gray-900 font-serif">{resena.autor}</span>
              <span class="text-xs text-gray-400 uppercase tracking-wider">{resena.plataforma}</span>
            </div>
          </div>
        ))}
      </div>

    </div>
  </section>
)}